package almacen;

public class Almacen<T extends IComparador>
{
	private Object[] elementos;

	private int cont;

	public Almacen(int numMaximo)
	{
		elementos = new Object[numMaximo];
		cont = 0;
	}

	public int getCapacidad()
	{
		return elementos.length;
	}

	public int getNumeroElementos()
	{
		return cont;
	}

	public boolean anadir(T t)
	{
		if(cont == elementos.length)
		{
			return false;
		}
		int posInsercion = buscarElemento(t);
		// Si el elemento ya existe, salimos
		if(posInsercion < 0)
		{
			return false;
		}
		//posInsercion--;
		for (int i = cont - 2; i >= posInsercion; i--)
		{
			elementos[i + 1] = elementos[i];
		}
		elementos[posInsercion] = t;
		cont++;
		return true;
	}

	/**
	 * Busca un elemento dentro del array
	 * @param t
	 * @return negativo desde -1 a -n si se encuentra el elemento.
	 * positivo desde 1 a n si no lo encuentra indicando la posición de inserción (restando 1)
	 */
	private int buscarElemento(T t)
	{
		int inicio = 0;
		int fin = cont - 1;
		int centro;
		while(inicio <= fin)
		{
			centro = (inicio + fin) / 2;
			if(t.sonIguales(elementos[centro]))
			{
				return (centro + 1) * -1;
			}
			else if(t.esMayor(elementos[centro]))
			{
				inicio = centro + 1;
			}
			else
			{
				fin = centro - 1;
			}
		}
		return inicio;
	}

	public boolean eliminar(T t)
	{
		if(cont == 0)
		{
			return false;
		}
		int posicionEliminar = buscarElemento(t);
		if(posicionEliminar < 0) // Se ha encontrado
		{
			posicionEliminar = (posicionEliminar--) * -1;
			for (int i = posicionEliminar; i < cont - 1; i++)
			{
				elementos[i] = elementos[i + 1];
			}
			cont--;
			return true;
		}
		else
		{
			return false;
		}
	}

	public boolean existe(T t)
	{
		if(buscarElemento(t) < 0)
		{
			return true;
		}
		else
		{
			return false;
		}
	}

	public Object[] getElementos()
	{
		Object[] aux = new Object[cont];
		for (int i = 0; i < aux.length; i++)
		{
			aux[i] = elementos[i];
		}
		return aux;
	}


}
